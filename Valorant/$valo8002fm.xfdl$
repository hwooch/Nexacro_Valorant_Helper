<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="valo8002fm" width="2000" height="980" titletext="회원 관리" onload="valo8002fm_onload" onclose="valo8002fm_onclose">
    <Layouts>
      <Layout height="980" mobileorientation="landscape" width="2000">
        <Static id="sta_discord_name" taborder="0" top="70" height="46" font="normal 30pt/normal &quot;AppleSDGothicNeoH00&quot;" color="white" text="회원 관리" fittocontents="width" textAlign="right" width="150" left="250" verticalAlign="bottom"/>
        <Grid id="grd_party" taborder="1" left="150" top="190" height="852" binddataset="gds_login" autofittype="col" borderRadius="20px 20px 0px 0px" tabstop="false" cssclass="grid_test" oncellclick="grd_party_oncellclick" scrolltype="none" scrollbartype="none none" width="1700">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="372"/>
                <Column size="372"/>
                <Column size="372"/>
                <Column size="372"/>
                <Column size="372"/>
                <Column size="372"/>
                <Column size="372"/>
              </Columns>
              <Rows>
                <Row size="60" band="head"/>
                <Row size="60"/>
              </Rows>
              <Band id="head">
                <Cell text="고유 ID"/>
                <Cell col="1" text="라이엇 아이디"/>
                <Cell col="2" text="라이엇 태그"/>
                <Cell col="3" text="디코 이름"/>
                <Cell col="4" text="가입 날짜"/>
                <Cell col="5" text="로그인 횟수"/>
                <Cell col="6" text="권한" font="normal 20px/normal &quot;이사만루체 Light&quot;"/>
              </Band>
              <Band id="body">
                <Cell text="bind:DISCORD_ID" border="0px,1px solid #292932,1px solid black,0px" textAlign="left" font="normal 13pt/normal &quot;이사만루체 Light&quot;" padding="0px 0px 0px 20px" cursor="pointer"/>
                <Cell col="1" textAlign="center" font="normal 15pt/normal &quot;이사만루체 Light&quot;" border="0px,1px solid #292932,1px solid black" imagestretch="fixaspectratio" text="bind:RIOT_ID" padding="10px"/>
                <Cell col="2" text="bind:RIOT_TAG" textAlign="center" font="normal 15pt/normal &quot;이사만루체 Light&quot;" border="0px,0px,1px solid black,1px solid #292932" imagestretch="fixaspectratio" padding="10px 0px 10px 10px"/>
                <Cell col="3" textAlign="center" font="normal 15pt/normal &quot;이사만루체 Light&quot;" border="0px,0px,1px solid black,1px solid #292932" imagestretch="fixaspectratio" text="bind:USER_NAME" padding="3px 0px 3px 10px"/>
                <Cell col="4" text="bind:SIGN_DATE" textAlign="left" font="normal 13pt/normal &quot;이사만루체 Light&quot;" border="0px,1px solid #292932,1px solid black" cursor="pointer" padding="0px 0px 0px 30px"/>
                <Cell col="5" border="0px,1px solid #292932,1px solid black" text="bind:LOGIN_COUNT" font="normal 13pt/normal &quot;이사만루체 Light&quot;" textAlign="center" color="#00ffba"/>
                <Cell col="6" text="bind:PERMISSION" border="0px,1px solid #292932,1px solid black" textAlign="center" font="normal 11pt/normal &quot;이사만루체 Light&quot;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_back" taborder="2" top="70" width="110" height="60" text="돌아가기" textAlign="center" cssclass="btn_back" onclick="btn_back_onclick" cursor="pointer" right="250"/>
        <Button id="btn_space_0" taborder="3" left="990" top="grd_party:0" width="120" height="30"/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.fvApp = nexacro.getApplication();

this.btn_back_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var objWorkFrame = this.fvApp.mainframe.VFrameSet00.WorkFrame;
	objWorkFrame.formurl = "Valorant::valo8001fm.xfdl";
};

this.valo8002fm_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	// 테마 변경 이벤트 핸들러 추가
    this.fvApp.gds_theme.addEventHandler("oncolumnchanged", this.fn_change_theme, this);
    
    // 최초 로드시 현재 저장된 테마를 강제로 한 번 적용
    this.fn_setThemeCss();
	
	this.resetScroll();
};

this.valo8002fm_onclose = function(obj:nexacro.Form,e:nexacro.CloseEventInfo)
{	
	// 테마 이벤트 핸들러 제거
    this.fvApp.gds_theme.removeEventHandler("oncolumnchanged", this.fn_change_theme, this);
};


this.fn_change_theme = function(obj:nexacro.NormalDataset, e:nexacro.DSColChangeEventInfo)
{
    // 데이터셋이 변경되었을 때 CSS 적용 함수 호출
    this.fn_setThemeCss();
};


// [수정] 실제 CSS를 변경하는 로직 (그리드 헤더 + 버튼 스타일 강제 리로딩)
this.fn_setThemeCss = function()
{
    // 현재 데이터셋에 설정된 값 가져오기
    var sThemeColor = this.fvApp.gds_theme.getColumn(0, "COLOR");
    
    // 값에 따라 스타일 적용
    if (sThemeColor == "white") {
        nexacro.loadStyle("xcssrc::theme_white.xcss");
        this.grd_party.setCellProperty( "head", 0, "background", "#9b9baf" );
        this.grd_party.setCellProperty( "head", 1, "background", "#85859d" );
        this.grd_party.setCellProperty( "head", 2, "background", "#9b9baf" );
        this.grd_party.setCellProperty( "head", 3, "background", "#85859d" );
        this.grd_party.setCellProperty( "head", 4, "background", "#9b9baf" );
        this.grd_party.setCellProperty( "head", 5, "background", "#85859d" );
        this.grd_party.setCellProperty( "head", 6, "background", "#9b9baf" );
        this.grd_party.setCellProperty( "head", 7, "background", "#85859d" );
        this.grd_party.setCellProperty( "head", 8, "background", "#9b9baf" );
        
    } else {
        nexacro.loadStyle("xcssrc::theme_black.xcss");
        this.grd_party.setCellProperty( "head", 0, "background", "#63637c" );
        this.grd_party.setCellProperty( "head", 1, "background", "#4d4d60" );
        this.grd_party.setCellProperty( "head", 2, "background", "#63637c" );
        this.grd_party.setCellProperty( "head", 3, "background", "#4d4d60" );
        this.grd_party.setCellProperty( "head", 4, "background", "#63637c" );
        this.grd_party.setCellProperty( "head", 5, "background", "#4d4d60" );
        this.grd_party.setCellProperty( "head", 6, "background", "#63637c" );
        this.grd_party.setCellProperty( "head", 7, "background", "#4d4d60" );
        this.grd_party.setCellProperty( "head", 8, "background", "#63637c" );
    }
    
    this.resetScroll();
};
]]></Script>
  </Form>
</FDL>
